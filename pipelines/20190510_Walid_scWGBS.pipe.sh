source $WZSEQ_ENTRY
wzref_mm10
pipeline_prepare

while read sname fastqname; do
  jump_comments

  ### QC fastq ####
  fastq1=fastq/${sname}_R1_001.fastq.gz
  fastq2=fastq/${sname}_R2_001.fastq.gz
  hour=48; memG=10; ppn=1; queue=shortq
  pipeline_depend none
  pipeline_eval 1 __wzseq_trim_galore_PE2

  fastq=fastq/${sname}_R1_001.fastq.gz
  fastq_sname=${sname}_R1
  hour=12; memG=5; ppn=1; queue=shortq
  pipeline_depend none
  pipeline_eval 2 __wzseq_fastqc

  fastq=fastq/${sname}_R2_001.fastq.gz
  fastq_sname=${sname}_R2
  hour=12; memG=5; ppn=1; queue=shortq
  pipeline_depend none
  pipeline_eval 3 __wzseq_fastqc

  ## alignment
  pipeline_depend none
  fastq1=fastq/${sname}_R1_001.fastq.gz
  fastq2=fastq/${sname}_R2_001.fastq.gz
  output_bam=bam/${sname}.bam
  hour=48; memG=200; ppn=28; queue=shortq
  pipeline_depend none
  pipeline_eval 11 __wgbs_biscuit_align_PE_Walid_lib
  bam=bam/${sname}.bam
  hour=1; memG=5; ppn=1
  pipeline_eval 12 __wzseq_index_bam

  input_bam=bam/${sname}.bam
  output_bam=bam/${sname}_markdup.bam
  hour=36; memG=10; ppn=2; queue=shortq
  pipeline_eval 13 __wgbs_biscuit_markdup
  bam=bam/${sname}_markdup.bam
  hour=1; memG=5; ppn=1; queue=shortq
  pipeline_eval 14 __wzseq_index_bam

  ## pileup
  input_bam=bam/${sname}_markdup.bam
  output_vcf=pileup/${sname}.vcf.gz
  hour=12; memG=80; ppn=20; queue=shortq
  pipeline_depend 14
  pipeline_eval 15 __wgbs_biscuit_pileup

  input_bam=bam/${sname}_markdup.bam
  input_vcf=pileup/${sname}.vcf.gz
  hour=48; memG=20; ppn=2; queue=shortq
  pipeline_eval 16 __wgbs_biscuit_QC

  input_bam=bam/${sname}_markdup.bam
  output_sname=$sname
  hour=24; memG=50; ppn=10; queue=shortq
  pipeline_depend 14
  pipeline_eval 23 __wzseq_qualimap_bamqc

  fastq=fastq/${sname}_L005_R1_001.fastq.gz
  output_bam=bam/${sname}_SE_mate1.bam
  hour=48; memG=200; ppn=28; queue=longq;
  pipeline_depend none
  pipeline_eval 50 __wgbs_biscuit_align_SE
  bam=bam/${sname}_SE_mate1.bam
  hour=1; memG=15; ppn=1; queue=longq;
  pipeline_eval 51 __wzseq_index_bam
  
  input_bam=bam/${sname}_SE_mate1.bam
  output_sname=${sname}_SE_mate1
  hour=24; memG=50; ppn=10; queue=shortq
  pipeline_depend none
  pipeline_eval 52 __wzseq_qualimap_bamqc
  
done << EOM
Col-2-A1	SE5227_FT-SA23990_S48_L006
Col-2-A3	SE5227_FT-SA23991_S49_L006
Col-2-A4	SE5227_FT-SA23992_S50_L006
Col-2-A8	SE5227_FT-SA23993_S51_L006
Col-2-B1	SE5227_FT-SA23994_S52_L006
Col-2-B3	SE5227_FT-SA23995_S53_L006
Col-2-B4	SE5227_FT-SA23996_S54_L006
Col-2-B5	SE5227_FT-SA23997_S55_L006
Col-2-D2	SE5227_FT-SA23998_S56_L006
Col-2-D3	SE5227_FT-SA23999_S57_L006
Col-2-D4	SE5227_FT-SA24000_S58_L006
Col-2-D5	SE5227_FT-SA24001_S59_L006
Col-3-E1	SE5250_FT-SA27060_S64_L005
Col-3-E10	SE5250_FT-SA27064_S68_L005
Col-3-E2	SE5250_FT-SA27061_S65_L005
Col-3-E4	SE5250_FT-SA27062_S66_L005
Col-3-E9	SE5250_FT-SA27063_S67_L005
Col-3-F12	SE5250_FT-SA27069_S73_L005
Col-3-F2	SE5250_FT-SA27065_S69_L005
Col-3-F3	SE5250_FT-SA27066_S70_L005
Col-3-F6	SE5250_FT-SA27067_S71_L005
Col-3-F9	SE5250_FT-SA27068_S72_L005
Col-3-G1	SE5250_FT-SA27070_S74_L005
Col-3-G7	SE5250_FT-SA27071_S75_L005
Col-3-G8	SE5250_FT-SA27072_S76_L005
Col-3-H10	SE5250_FT-SA27075_S79_L005
Col-3-H2	SE5250_FT-SA27073_S77_L005
Col-3-H3	SE5250_FT-SA27074_S78_L005
Col-4-A10	SE5249_FT-SA27009_S84_L006
Col-4-A12	SE5249_FT-SA27010_S85_L006
Col-4-A3	SE5249_FT-SA27005_S80_L006
Col-4-A5	SE5249_FT-SA27006_S81_L006
Col-4-A6	SE5249_FT-SA27007_S82_L006
Col-4-A7	SE5249_FT-SA27008_S83_L006
Col-4-B1	SE5249_FT-SA27011_S86_L006
Col-4-B10	SE5249_FT-SA27018_S93_L006
Col-4-B2	SE5249_FT-SA27012_S87_L006
Col-4-B3	SE5249_FT-SA27013_S88_L006
Col-4-B4	SE5249_FT-SA27014_S89_L006
Col-4-B5	SE5249_FT-SA27015_S90_L006
Col-4-B6	SE5249_FT-SA27016_S91_L006
Col-4-B7	SE5249_FT-SA27017_S92_L006
SI-2-E2	SE5228_FT-SA23978_S60_L007
SI-2-E3	SE5228_FT-SA23979_S61_L007
SI-2-E8	SE5228_FT-SA23980_S62_L007
SI-2-E9	SE5228_FT-SA23981_S63_L007
SI-2-F1	SE5228_FT-SA23982_S64_L007
SI-2-F2	SE5228_FT-SA23983_S65_L007
SI-2-F4	SE5228_FT-SA23984_S66_L007
SI-2-F5	SE5228_FT-SA23985_S67_L007
SI-2-F6	SE5228_FT-SA23986_S68_L007
SI-2-F7	SE5228_FT-SA23987_S69_L007
SI-2-F8	SE5228_FT-SA23988_S70_L007
SI-2-G1	SE5229_FT-SA24002_S72_L008
SI-2-G2	SE5229_FT-SA24003_S73_L008
SI-2-G3	SE5229_FT-SA24004_S74_L008
SI-2-G4	SE5229_FT-SA24005_S75_L008
SI-2-G5	SE5229_FT-SA24006_S76_L008
SI-2-G6	SE5229_FT-SA24007_S77_L008
SI-2-G7	SE5229_FT-SA24008_S78_L008
SI-2-G8	SE5229_FT-SA24009_S79_L008
SI-2-H1	SE5229_FT-SA24010_S80_L008
SI-2-H2	SE5229_FT-SA24011_S81_L008
SI-2-H4	SE5228_FT-SA23989_S71_L007
SI-2-H5	SE5229_FT-SA24012_S82_L008
SI-2-H7	SE5229_FT-SA24013_S83_L008
SI-3-A10	SE5250_FT-SA27050_S54_L005
SI-3-A11	SE5250_FT-SA27051_S55_L005
SI-3-A2	SE5250_FT-SA27045_S49_L005
SI-3-A3	SE5250_FT-SA27046_S50_L005
SI-3-A4	SE5250_FT-SA27047_S51_L005
SI-3-A5	SE5250_FT-SA27048_S52_L005
SI-3-A8	SE5250_FT-SA27049_S53_L005
SI-3-B1	SE5250_FT-SA27052_S56_L005
SI-3-B11	SE5250_FT-SA27053_S57_L005
SI-3-C1	SE5250_FT-SA27054_S58_L005
SI-3-C11	SE5250_FT-SA27056_S60_L005
SI-3-C9	SE5250_FT-SA27055_S59_L005
SI-3-D1	SE5250_FT-SA27057_S61_L005
SI-3-D3	SE5250_FT-SA27058_S62_L005
SI-3-D9	SE5250_FT-SA27059_S63_L005
SI-4-C1	SE5249_FT-SA27019_S94_L006
SI-4-C10	SE5249_FT-SA27024_S99_L006
SI-4-C2	SE5249_FT-SA27020_S95_L006
SI-4-C3	SE5249_FT-SA27021_S96_L006
SI-4-C4	SE5249_FT-SA27022_S97_L006
SI-4-C8	SE5249_FT-SA27023_S98_L006
SI-4-D12	SE5249_FT-SA27027_S102_L006
SI-4-D3	SE5249_FT-SA27025_S100_L006
SI-4-D5	SE5249_FT-SA27026_S101_L006
SI-4-E1	SE5249_FT-SA27028_S103_L006
SI-4-E11	SE5249_FT-SA27031_S106_L006
SI-4-E2	SE5249_FT-SA27029_S104_L006
SI-4-E5	SE5249_FT-SA27030_S105_L006
SI-4-F1	SE5249_FT-SA27032_S107_L006
SI-4-F2	SE5249_FT-SA27033_S108_L006
SI-4-F3	SE5249_FT-SA27034_S109_L006
SI-4-F4	SE5249_FT-SA27035_S110_L006
SI-4-F5	SE5249_FT-SA27036_S111_L006
SI-4-F7	SE5249_FT-SA27037_S112_L006
SI-4-G1	SE5249_FT-SA27038_S113_L006
SI-4-G11	SE5249_FT-SA27041_S116_L006
SI-4-G3	SE5249_FT-SA27039_S114_L006
SI-4-G7	SE5249_FT-SA27040_S115_L006
SI-4-H4	SE5249_FT-SA27042_S117_L006
SI-4-H8	SE5249_FT-SA27043_S118_L006
SI-4-H9	SE5249_FT-SA27044_S119_L006
EOM

